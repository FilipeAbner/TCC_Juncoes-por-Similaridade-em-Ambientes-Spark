services:
  spark-worker:
    build: .
    container_name: spark-worker
    env_file:
      - .env
    network_mode: host  # Usa rede do host para multi-máquina
    volumes:
      - /mnt/master-apps:/apps
    environment:
      - SPARK_MASTER_URL=${SPARK_MASTER_URL}
      - SPARK_WORKER_WEBUI_PORT=${SPARK_WORKER_WEBUI_PORT}
      - SPARK_WORKER_CORES=${SPARK_WORKER_CORES:-2}
      - SPARK_WORKER_MEMORY=${SPARK_WORKER_MEMORY:-2g}
      - SPARK_LOCAL_IP=${SPARK_LOCAL_IP}  # IP real da máquina worker

# Nota: network_mode: host não é compatível com networks, ports e extra_hosts
# As portas são expostas diretamente na rede do host